# 전처리 의사결정 기록

---

## 1. 날짜 타입 변환


###  **InvoiceDate를 datetime으로 변환**

- **근거**: 

&nbsp; - 날짜 연산 필요 (코호트 분석)

&nbsp; - 시간대 분석, 월별 집계에 활용

&nbsp; - PostgreSQL TIMESTAMP 타입으로 저장



---



## 2. 'A'로 시작하는 InvoiceNo 처리


### 발견
- 음수 가격: 2건
- InvoiceNo: A563186, A563187 (음수 가격 2건 모두 'A'로 시작)
- Description: "Adjust bad debt"
- 확인 결과 나머지 A 1건도 동일한 회계 조정 항목

### 결정

 **InvoiceNo 'A'로 시작하는 모든 레코드 제거**

- **제거 건수**: 3건

- **근거**:

&nbsp; 1. 실제 상품 거래가 아닌 장부 조정

&nbsp; 2. 고객 행동과 무관

&nbsp; 3. 매출 분석 왜곡 (이상 금액), 코호트/RFM 분석 방해


### 참고: InvoiceNo 패턴별 처리

| 패턴 | 의미 | 처리 | 이유 |
|------|------|------|------|
| 숫자만 | 정상 주문 | ✅ 보존 | 분석 대상 |
| C로 시작 | 취소/반품 | ✅ 보존 | 실제 고객 행동 |
| A로 시작 | 회계 조정 | ❌ 제거 | 분석 대상 아님 |

---



## 3. StockCode 대소문자



### 발견

- 'M'과 'm' 코드 존재

- Description: 모두 'Manual'로 동일

- 대소문자 차이로 인한 중복 가능성

- 하지만 일부 코드는 의도적 구분 가능성 있음


### 결정

 **원본 유지 (대소문자 변환 안 함)**


- **근거**:

&nbsp; 1. 다른 코드의 대소문자 의미 확신 없음

&nbsp; 4. 필요시 UPPER() 함수로 통일 및 SQL 뷰에서 처리 가능


---



## 4. 결측치


### CustomerID (135,080건, 24.9%)
&nbsp; - 비회원 구매 추정
&nbsp; - 전체 매출 분석에 필요

### Description (1,454건, 0.27%) 
&nbsp; - 상품명 누락 가능성 
&nbsp; - 소량 (0.27%)
&nbsp; - StockCode로 상품 식별 가능


**결정**: ✅ **보존**
&nbsp; - DB: NULL 그대로 적재



---



## 5. 이상치

### 음수 UnitPrice (2건)

**결정**: ✅ **제거됨 (InvoiceNo 'A' 제거로 자동 해결)**


### 음수 Quantity (10,624건)

**결정**: ✅ **보존**


- **근거**:

&nbsp; 1. 실제 고객 행동 (취소/반품)

&nbsp; 2.  InvoiceNo 'C'로 시작과 100% 일치

&nbsp; 3. 필요시 SQL 뷰에서 제외



---



## 전처리 요약

| 항목 | 처리 | 건수 | 비율 |
|------|------|------|------|
| **제거** | InvoiceNo 'A' | 3건 | 0.0006% |
| **변환** | 날짜 타입 | 전체 | 100% |
| **보존** | CustomerID NULL | 135,080건 | 24.9% |
| **보존** | Description NULL | 1,454건 | 0.27% |
| **보존** | 음수 Quantity | 10,624건 | 2.0% |
| **보존** | StockCode 대소문자 | - | - |



**최종 레코드**: 541,906건 (원본 541,909건)





